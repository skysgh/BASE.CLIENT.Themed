<!-- Spike Insights View (I in I-BREAST-D) -->
<div class="spike-insights">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h4 class="mb-1">
        <i class="bx bx-bar-chart-alt-2 me-2"></i>
        Spike Insights
      </h4>
      <p class="text-muted mb-0">Analytics and reports across all spikes</p>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-outline-secondary" (click)="goToBrowse()">
        <i class="bx bx-list-ul me-1"></i>
        Browse
      </button>
      <button class="btn btn-primary" (click)="goToAdd()">
        <i class="bx bx-plus me-1"></i>
        New Spike
      </button>
    </div>
  </div>

  <!-- Summary Cards -->
  <div class="row mb-4">
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card card-metric">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <div class="metric-icon bg-primary-subtle text-primary">
              <i class="bx bx-bulb"></i>
            </div>
            <div class="ms-3">
              <h3 class="mb-0">{{metrics.total}}</h3>
              <p class="text-muted mb-0 small">Total Spikes</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card card-metric">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <div class="metric-icon bg-success-subtle text-success">
              <i class="bx bx-check-circle"></i>
            </div>
            <div class="ms-3">
              <h3 class="mb-0">{{metrics.completedThisMonth}}</h3>
              <p class="text-muted mb-0 small">Completed This Month</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card card-metric">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <div class="metric-icon bg-danger-subtle text-danger">
              <i class="bx bx-error-circle"></i>
            </div>
            <div class="ms-3">
              <h3 class="mb-0">{{metrics.overdueCount}}</h3>
              <p class="text-muted mb-0 small">Overdue</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card card-metric">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <div class="metric-icon bg-info-subtle text-info">
              <i class="bx bx-time"></i>
            </div>
            <div class="ms-3">
              <h3 class="mb-0">{{metrics.totalEstimatedEffort}}</h3>
              <p class="text-muted mb-0 small">Est. Hours</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row">
    <!-- Status Distribution -->
    <div class="col-lg-6 mb-4">
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bx bx-pie-chart-alt me-2"></i>
            Status Distribution
          </h5>
        </div>
        <div class="card-body">
          <!-- Simple bar representation (replace with ApexCharts later) -->
          <div class="chart-placeholder">
            <div *ngFor="let item of statusChartData" class="chart-bar-item mb-3">
              <div class="d-flex justify-content-between mb-1">
                <span>{{item.label}}</span>
                <span class="fw-medium">{{item.value}}</span>
              </div>
              <div class="progress" style="height: 8px;">
                <div 
                  class="progress-bar" 
                  [style.width.%]="metrics.total ? (item.value / metrics.total) * 100 : 0"
                  [style.background-color]="item.color">
                </div>
              </div>
            </div>
            <div *ngIf="statusChartData.length === 0" class="text-center text-muted py-4">
              <i class="bx bx-bar-chart display-4"></i>
              <p class="mt-2">No data available</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Priority Distribution -->
    <div class="col-lg-6 mb-4">
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bx bx-flag me-2"></i>
            Priority Distribution
          </h5>
        </div>
        <div class="card-body">
          <div class="chart-placeholder">
            <div *ngFor="let item of priorityChartData" class="chart-bar-item mb-3">
              <div class="d-flex justify-content-between mb-1">
                <span>{{item.label}}</span>
                <span class="fw-medium">{{item.value}}</span>
              </div>
              <div class="progress" style="height: 8px;">
                <div 
                  class="progress-bar" 
                  [style.width.%]="metrics.total ? (item.value / metrics.total) * 100 : 0"
                  [style.background-color]="item.color">
                </div>
              </div>
            </div>
            <div *ngIf="priorityChartData.length === 0" class="text-center text-muted py-4">
              <i class="bx bx-bar-chart display-4"></i>
              <p class="mt-2">No data available</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Effort Comparison -->
  <div class="row">
    <div class="col-12 mb-4">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bx bx-timer me-2"></i>
            Effort: Estimated vs Actual
          </h5>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-md-4">
              <div class="py-3">
                <h2 class="text-primary mb-1">{{metrics.totalEstimatedEffort}}</h2>
                <p class="text-muted mb-0">Estimated Hours</p>
              </div>
            </div>
            <div class="col-md-4">
              <div class="py-3">
                <h2 class="text-success mb-1">{{metrics.totalActualEffort}}</h2>
                <p class="text-muted mb-0">Actual Hours</p>
              </div>
            </div>
            <div class="col-md-4">
              <div class="py-3">
                <h2 [class]="metrics.totalActualEffort > metrics.totalEstimatedEffort ? 'text-danger' : 'text-success'" class="mb-1">
                  {{metrics.totalEstimatedEffort - metrics.totalActualEffort}}
                </h2>
                <p class="text-muted mb-0">Variance</p>
              </div>
            </div>
          </div>
          
          <!-- Comparison Bar -->
          <div class="mt-3">
            <div class="d-flex gap-2 align-items-center mb-2">
              <span class="badge bg-primary">Estimated</span>
              <div class="progress flex-grow-1" style="height: 20px;">
                <div 
                  class="progress-bar bg-primary" 
                  [style.width.%]="100">
                </div>
              </div>
            </div>
            <div class="d-flex gap-2 align-items-center">
              <span class="badge bg-success" style="width: 68px;">Actual</span>
              <div class="progress flex-grow-1" style="height: 20px;">
                <div 
                  class="progress-bar bg-success" 
                  [style.width.%]="metrics.totalEstimatedEffort ? (metrics.totalActualEffort / metrics.totalEstimatedEffort) * 100 : 0">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Future: Add more chart sections -->
  <!-- 
    - Timeline/Gantt of due dates
    - Completion trends over time (line chart)
    - Category breakdown
    - Tag cloud
  -->
</div>
